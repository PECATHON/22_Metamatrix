<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <title>Campus Food Hub - Student Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"><!-- Tailwind via CDN -->
  <script src="https://cdn.tailwindcss.com"></script><!-- Canva SDKs -->
  <script src="/_sdk/element_sdk.js"></script>
  <style>
    body {
      box-sizing: border-box;
    }
    html, body {
      height: 100%;
    }
    /* Custom scrollbar (playful) */
    .custom-scrollbar::-webkit-scrollbar {
      width: 8px;
    }
    .custom-scrollbar::-webkit-scrollbar-track {
      background: rgba(147, 51, 234, 0.1);
      border-radius: 999px;
    }
    .custom-scrollbar::-webkit-scrollbar-thumb {
      background: linear-gradient(180deg, #a855f7, #9333ea);
      border-radius: 999px;
    }
    .star {
      cursor: pointer;
      transition: transform 150ms ease, color 150ms ease;
    }
    .star:hover {
      transform: scale(1.2) rotate(15deg);
    }
    .star.active {
      color: #fbbf24;
      filter: drop-shadow(0 0 8px rgba(251, 191, 36, 0.6));
    }
    .modal-backdrop {
      background: rgba(88, 28, 135, 0.7);
      backdrop-filter: blur(4px);
    }
    .focus-outline:focus-visible {
      outline: 3px solid #a855f7;
      outline-offset: 2px;
    }
    .food-card {
      transition: all 300ms cubic-bezier(0.4, 0, 0.2, 1);
    }
    .food-card:hover {
      transform: translateY(-8px) scale(1.02);
      box-shadow: 0 20px 40px rgba(147, 51, 234, 0.3);
    }
    .bounce-in {
      animation: bounceIn 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    }
    @keyframes bounceIn {
      0% { transform: scale(0.3); opacity: 0; }
      50% { transform: scale(1.05); }
      70% { transform: scale(0.9); }
      100% { transform: scale(1); opacity: 1; }
    }
    .wiggle {
      animation: wiggle 0.5s ease-in-out;
    }
    @keyframes wiggle {
      0%, 100% { transform: rotate(0deg); }
      25% { transform: rotate(-5deg); }
      75% { transform: rotate(5deg); }
    }
    .food-emoji {
      font-size: 4rem;
      filter: drop-shadow(0 4px 12px rgba(147, 51, 234, 0.3));
      transition: transform 300ms ease;
    }
    .food-card:hover .food-emoji {
      transform: scale(1.15) rotate(5deg);
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="h-full bg-gradient-to-br from-purple-100 via-pink-50 to-purple-50 text-purple-900 antialiased">
  <header class="w-full border-b-4 border-purple-400 bg-gradient-to-r from-purple-600 via-pink-500 to-purple-600 shadow-lg">
   <nav class="max-w-6xl mx-auto flex items-center justify-between px-4 py-4">
    <div class="flex items-center gap-3">
     <div class="w-12 h-12 rounded-2xl bg-white flex items-center justify-center text-3xl shadow-lg transform hover:rotate-12 transition-transform">
      üçî
     </div>
     <div>
      <h1 id="appTitle" class="text-xl font-bold leading-tight text-white drop-shadow-md">Campus Food Hub</h1>
      <p class="text-xs text-purple-100 font-medium">üéâ Student Dashboard</p>
     </div>
    </div>
    <div class="flex items-center gap-4">
     <p id="studentName" class="text-sm text-white font-medium">Welcome, Student üëã</p><button id="logoutBtn" type="button" class="focus-outline rounded-full bg-white px-4 py-2 text-xs font-bold text-purple-600 hover:bg-purple-50 hover:scale-105 transition-all shadow-md"> Logout </button>
    </div>
   </nav>
  </header>
  <main class="h-full">
   <section class="max-w-6xl mx-auto px-4 pt-4 pb-6 h-full flex flex-col gap-4"><!-- Status / toast area -->
    <div id="statusBar" class="hidden rounded-xl border-2 border-purple-400 bg-purple-100 px-4 py-2 text-sm font-bold text-purple-700 shadow-lg"></div>
    <div class="flex-1 flex gap-4 min-h-0"><!-- Sidebar -->
     <aside class="w-52 shrink-0 rounded-2xl bg-gradient-to-b from-white to-purple-50 border-2 border-purple-300 p-3 flex flex-col gap-2 shadow-xl">
      <h2 class="text-xs font-bold uppercase tracking-wide text-purple-600 mb-1 flex items-center gap-1"><span>‚ú®</span> Menu</h2><button type="button" data-section="browse" class="menu-btn focus-outline flex items-center gap-2 rounded-xl px-3 py-2.5 text-sm font-bold text-white bg-gradient-to-r from-purple-500 to-pink-500 shadow-md hover:shadow-lg hover:scale-105 transition-all"> <span class="text-lg">üçï</span><span>Browse Menu</span> </button> <button type="button" data-section="orders" class="menu-btn focus-outline flex items-center gap-2 rounded-xl px-3 py-2.5 text-sm font-semibold text-purple-700 hover:bg-purple-100 hover:scale-105 transition-all"> <span class="text-lg">üì¶</span><span>My Orders</span> </button> <button type="button" data-section="reviews" class="menu-btn focus-outline flex items-center gap-2 rounded-xl px-3 py-2.5 text-sm font-semibold text-purple-700 hover:bg-purple-100 hover:scale-105 transition-all"> <span class="text-lg">‚≠ê</span><span>My Reviews</span> </button> <button type="button" data-section="cart" class="menu-btn focus-outline mt-2 flex items-center justify-between rounded-xl px-3 py-2.5 text-sm font-semibold text-purple-700 hover:bg-purple-100 hover:scale-105 transition-all"> <span class="flex items-center gap-2"> <span class="text-lg">üõí</span><span>Cart</span> </span> <span class="inline-flex min-w-[1.5rem] items-center justify-center rounded-full bg-gradient-to-r from-pink-400 to-purple-500 px-2 py-0.5 text-[11px] font-bold text-white shadow-md"> <span id="cartCount">0</span> </span> </button>
     </aside><!-- Main content -->
     <section class="flex-1 min-w-0 rounded-2xl bg-white border border-purple-200 p-4 flex flex-col gap-4 shadow-sm"><!-- Browse -->
      <section id="section-browse" class="content-section flex flex-col gap-4 min-h-0">
       <div class="flex flex-col gap-1">
        <h2 class="text-lg font-semibold text-purple-900">Browse Menu</h2>
        <p class="text-xs text-purple-600">Search, filter, and add items to your cart.</p>
       </div>
       <form id="searchForm" class="flex flex-col gap-2 md:flex-row md:items-center" aria-label="Browse filters">
        <div class="flex-1 relative"><label for="searchFood" class="sr-only">Search food</label> <span class="pointer-events-none absolute left-3 top-1/2 -translate-y-1/2 text-purple-400 text-sm">üîç</span> <input id="searchFood" name="searchFood" type="text" class="w-full rounded-xl border border-purple-200 bg-purple-50/50 pl-8 pr-3 py-2 text-sm text-purple-900 placeholder-purple-400 focus:outline-none focus:ring-2 focus:ring-purple-500" placeholder="Search food items...">
        </div>
        <div class="flex gap-2">
         <div><label for="vendorFilter" class="sr-only">Vendor filter</label> <select id="vendorFilter" name="vendorFilter" class="rounded-xl border border-purple-200 bg-purple-50/50 px-3 py-2 text-xs text-purple-900 focus:outline-none focus:ring-2 focus:ring-purple-500"> <option value="">All Vendors</option> </select>
         </div>
         <div><label for="categoryFilter" class="sr-only">Category filter</label> <select id="categoryFilter" name="categoryFilter" class="rounded-xl border border-purple-200 bg-purple-50/50 px-3 py-2 text-xs text-purple-900 focus:outline-none focus:ring-2 focus:ring-purple-500"> <option value="">All Categories</option> <option value="Snacks">Snacks</option> <option value="Meals">Meals</option> <option value="Beverages">Beverages</option> <option value="Desserts">Desserts</option> </select>
         </div>
        </div>
       </form>
       <div id="foodGrid" class="grid gap-3 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 custom-scrollbar overflow-y-auto pr-1"><!-- Cards injected via JS -->
       </div>
      </section><!-- Orders -->
      <section id="section-orders" class="content-section hidden flex flex-col gap-3 min-h-0">
       <div>
        <h2 class="text-lg font-semibold">My Orders</h2>
        <p class="text-xs text-slate-400">Track what you‚Äôve ordered so far.</p>
       </div>
       <div id="ordersList" class="custom-scrollbar overflow-y-auto pr-1 flex flex-col gap-2 text-sm"><!-- Orders injected -->
       </div>
      </section><!-- Reviews -->
      <section id="section-reviews" class="content-section hidden flex flex-col gap-3 min-h-0">
       <div>
        <h2 class="text-lg font-semibold text-purple-900">My Reviews</h2>
        <p class="text-xs text-purple-600">See and manage your feedback.</p>
       </div>
       <div id="reviewsList" class="custom-scrollbar overflow-y-auto pr-1 flex flex-col gap-2 text-sm"><!-- Reviews injected -->
       </div>
      </section><!-- Cart -->
      <section id="section-cart" class="content-section hidden flex flex-col gap-4 min-h-0">
       <div>
        <h2 class="text-lg font-semibold text-purple-900">Shopping Cart</h2>
        <p class="text-xs text-purple-600">Review items before placing your order.</p>
       </div>
       <div id="cartItems" class="custom-scrollbar overflow-y-auto pr-1 flex flex-col gap-2 text-sm"><!-- Cart items injected -->
       </div>
       <div class="mt-auto flex items-center justify-between rounded-xl border border-purple-200 bg-purple-50 px-4 py-3">
        <div class="flex flex-col"><span class="text-xs text-purple-600">Total</span> <span class="text-lg font-semibold text-purple-700"> ‚Çπ<span id="cartTotal">0</span> </span>
        </div><button id="placeOrderBtn" type="button" class="focus-outline rounded-full bg-purple-600 px-5 py-2 text-sm font-semibold text-white hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"> Place Order </button>
       </div>
      </section>
     </section>
    </div>
   </section>
  </main><!-- Review Modal -->
  <div id="reviewModal" class="fixed inset-0 z-20 hidden items-center justify-center p-4 modal-backdrop" aria-labelledby="reviewModalTitle" role="dialog" aria-modal="true">
   <div class="w-full max-w-md rounded-2xl bg-white border border-purple-200 p-5 shadow-xl relative"><button id="closeReviewModalBtn" type="button" class="absolute right-3 top-3 text-purple-400 hover:text-purple-700 focus-outline rounded-full" aria-label="Close review dialog"> ‚úï </button>
    <h2 id="reviewModalTitle" class="text-lg font-semibold text-purple-900 mb-2">Write a Review</h2>
    <p id="reviewItemName" class="text-sm text-purple-700 mb-3"></p>
    <div class="mb-3">
     <p class="text-xs text-purple-600 mb-1">Your rating</p>
     <div class="flex items-center gap-1 text-2xl text-purple-300" aria-label="Star rating"><button type="button" class="star focus-outline" data-rating="1" aria-label="1 star">‚òÖ</button> <button type="button" class="star focus-outline" data-rating="2" aria-label="2 stars">‚òÖ</button> <button type="button" class="star focus-outline" data-rating="3" aria-label="3 stars">‚òÖ</button> <button type="button" class="star focus-outline" data-rating="4" aria-label="4 stars">‚òÖ</button> <button type="button" class="star focus-outline" data-rating="5" aria-label="5 stars">‚òÖ</button>
     </div>
    </div>
    <div class="mb-4"><label for="reviewText" class="block text-xs text-purple-600 mb-1">Your review</label> <textarea id="reviewText" rows="4" class="w-full rounded-xl border border-purple-200 bg-purple-50/50 px-3 py-2 text-sm text-purple-900 placeholder-purple-400 focus:outline-none focus:ring-2 focus:ring-purple-500" placeholder="Share your experience..."></textarea>
    </div>
    <div class="flex justify-end gap-2"><button type="button" id="cancelReviewBtn" class="focus-outline rounded-full border border-purple-300 px-4 py-1.5 text-xs text-purple-700 hover:bg-purple-50"> Cancel </button> <button type="button" id="submitReviewBtn" class="focus-outline rounded-full bg-purple-600 px-4 py-1.5 text-xs font-semibold text-white hover:bg-purple-700"> Submit Review </button>
    </div>
   </div>
  </div>
  <footer class="w-full border-t-2 border-purple-300 bg-gradient-to-r from-purple-100 to-pink-100">
   <div class="max-w-6xl mx-auto px-4 py-3 text-xs text-purple-700 font-medium flex items-center justify-between"><span>üçï Made with ‚ù§Ô∏è for hungry students</span> <span>‚ú® Demo dashboard ¬∑ No real orders placed</span>
   </div>
  </footer>
  <script>
    // -------- Demo Data --------
    const MENU_ITEMS = [
      { id: "1", name: "Margherita Pizza", vendor: "Campus Caf√©", category: "Meals", price: 180, description: "Classic cheese & tomato with basil.", emoji: "üçï" },
      { id: "2", name: "Veg Burger", vendor: "Food Court", category: "Meals", price: 120, description: "Grilled patty with fresh toppings.", emoji: "üçî" },
      { id: "3", name: "French Fries", vendor: "Campus Caf√©", category: "Snacks", price: 70, description: "Crispy golden fries.", emoji: "üçü" },
      { id: "4", name: "Cold Coffee", vendor: "Brew Bar", category: "Beverages", price: 90, description: "Chilled and refreshing.", emoji: "‚òï" },
      { id: "5", name: "Brownie Sundae", vendor: "Sweet Spot", category: "Desserts", price: 140, description: "Warm brownie with ice cream.", emoji: "üç®" },
      { id: "6", name: "Masala Maggi", vendor: "Night Canteen", category: "Snacks", price: 60, description: "Comfort bowl with veggies.", emoji: "üçú" }
    ];

    // -------- State --------
    let activeSection = "browse";
    let cart = []; // {id, name, price, vendor, quantity}
    let orders = []; // {id, items, total, time}
    let reviews = []; // {id, itemId, itemName, rating, text, time}
    let reviewContext = { itemId: null, itemName: "" };
    let currentRating = 0;

    // -------- Utilities --------
    function showStatus(message, type = "success") {
      const bar = document.getElementById("statusBar");
      bar.textContent = message;
      bar.classList.remove("hidden");
      bar.classList.remove("border-purple-400", "bg-purple-100", "text-purple-700", "border-pink-400", "bg-pink-100", "text-pink-700");
      if (type === "error") {
        bar.classList.add("border-pink-400", "bg-pink-100", "text-pink-700");
      } else {
        bar.classList.add("border-purple-400", "bg-purple-100", "text-purple-700");
      }
      bar.classList.add("wiggle");
      setTimeout(() => {
        bar.classList.remove("wiggle");
      }, 500);
      setTimeout(() => {
        bar.classList.add("hidden");
      }, 2500);
    }

    // -------- Navigation --------
    function setActiveSection(section) {
      activeSection = section;
      document.querySelectorAll(".menu-btn").forEach(btn => {
        const sec = btn.getAttribute("data-section");
        if (sec === section) {
          btn.classList.remove("text-purple-700", "hover:bg-purple-100");
          btn.classList.add("bg-gradient-to-r", "from-purple-500", "to-pink-500", "text-white", "font-bold", "shadow-md", "hover:shadow-lg", "hover:scale-105");
        } else {
          btn.classList.add("text-purple-700", "hover:bg-purple-100");
          btn.classList.remove("bg-gradient-to-r", "from-purple-500", "to-pink-500", "text-white", "font-bold", "shadow-md", "hover:shadow-lg", "hover:scale-105");
        }
      });

      document.querySelectorAll(".content-section").forEach(sec => sec.classList.add("hidden"));
      const target = document.getElementById("section-" + section);
      if (target) target.classList.remove("hidden");
    }

    // -------- Browse / Filters --------
    function populateVendorFilter() {
      const select = document.getElementById("vendorFilter");
      const vendors = Array.from(new Set(MENU_ITEMS.map(i => i.vendor))).sort();
      vendors.forEach(v => {
        const opt = document.createElement("option");
        opt.value = v;
        opt.textContent = v;
        select.appendChild(opt);
      });
    }

    function getFilteredMenu() {
      const search = document.getElementById("searchFood").value.trim().toLowerCase();
      const vendor = document.getElementById("vendorFilter").value;
      const category = document.getElementById("categoryFilter").value;

      return MENU_ITEMS.filter(item => {
        const matchSearch =
          !search ||
          item.name.toLowerCase().includes(search) ||
          item.vendor.toLowerCase().includes(search) ||
          item.category.toLowerCase().includes(search);
        const matchVendor = !vendor || item.vendor === vendor;
        const matchCategory = !category || item.category === category;
        return matchSearch && matchVendor && matchCategory;
      });
    }

    function renderMenu() {
      const grid = document.getElementById("foodGrid");
      grid.innerHTML = "";
      const list = getFilteredMenu();
      if (list.length === 0) {
        grid.innerHTML = '<p class="text-sm text-purple-500 col-span-full text-center py-8">üò¢ No items found. Try different filters!</p>';
        return;
      }
      list.forEach((item, index) => {
        const card = document.createElement("article");
        card.className =
          "food-card bounce-in flex flex-col rounded-2xl border-2 border-purple-300 bg-gradient-to-br from-white to-purple-50 p-4 shadow-lg";
        card.style.animationDelay = `${index * 0.1}s`;
        card.innerHTML = `
          <div class="flex flex-col items-center mb-3">
            <div class="food-emoji mb-2">${item.emoji}</div>
            <h3 class="text-base font-bold text-purple-900 text-center">${item.name}</h3>
            <p class="text-xs text-purple-600 font-medium">${item.vendor}</p>
          </div>
          <div class="flex justify-center mb-2">
            <span class="text-xs px-3 py-1 rounded-full bg-gradient-to-r from-pink-400 to-purple-400 text-white font-bold shadow-sm">${item.category}</span>
          </div>
          <p class="text-xs text-purple-700 mb-3 text-center line-clamp-2">${item.description}</p>
          <div class="mt-auto flex items-center justify-between pt-2 border-t-2 border-purple-200">
            <span class="text-lg font-bold text-purple-600">‚Çπ${item.price}</span>
            <button
              type="button"
              class="focus-outline rounded-full bg-gradient-to-r from-purple-500 to-pink-500 px-4 py-2 text-xs font-bold text-white hover:from-purple-600 hover:to-pink-600 hover:scale-110 transition-all shadow-md"
              data-add-to-cart="${item.id}"
            >
              Add to Cart üõí
            </button>
          </div>
        `;
        grid.appendChild(card);
      });
    }

    function handleBrowseInteractions() {
      document.getElementById("searchForm").addEventListener("submit", e => e.preventDefault());
      document.getElementById("searchFood").addEventListener("input", renderMenu);
      document.getElementById("vendorFilter").addEventListener("change", renderMenu);
      document.getElementById("categoryFilter").addEventListener("change", renderMenu);

      document.getElementById("foodGrid").addEventListener("click", e => {
        const btn = e.target.closest("[data-add-to-cart]");
        if (!btn) return;
        const id = btn.getAttribute("data-add-to-cart");
        const item = MENU_ITEMS.find(i => i.id === id);
        if (!item) return;
        addToCart(item);
      });
    }

    // -------- Cart --------
    function addToCart(item) {
      const existing = cart.find(i => i.id === item.id);
      if (existing) {
        existing.quantity += 1;
      } else {
        cart.push({ id: item.id, name: item.name, vendor: item.vendor, price: item.price, quantity: 1 });
      }
      renderCart();
      showStatus("Added to cart.");
    }

    function updateCartCount() {
      const count = cart.reduce((acc, cur) => acc + cur.quantity, 0);
      document.getElementById("cartCount").textContent = count;
    }

    function renderCart() {
      const container = document.getElementById("cartItems");
      container.innerHTML = "";
      if (cart.length === 0) {
        container.innerHTML = '<div class="text-center py-8"><p class="text-4xl mb-2">üõí</p><p class="text-sm text-purple-600 font-medium">Your cart is empty. Start by adding something tasty!</p></div>';
      } else {
        cart.forEach(item => {
          const menuItem = MENU_ITEMS.find(m => m.id === item.id);
          const emoji = menuItem ? menuItem.emoji : "üçΩÔ∏è";
          const row = document.createElement("div");
          row.className =
            "flex items-center justify-between rounded-xl border-2 border-purple-300 bg-gradient-to-r from-white to-purple-50 px-4 py-3 gap-3 shadow-md hover:shadow-lg transition-all";
          row.innerHTML = `
            <div class="flex items-center gap-3 flex-1">
              <span class="text-3xl">${emoji}</span>
              <div>
                <p class="text-sm font-bold text-purple-900">${item.name}</p>
                <p class="text-xs text-purple-600">${item.vendor}</p>
              </div>
            </div>
            <div class="flex items-center gap-2 text-sm">
              <button type="button" class="focus-outline w-7 h-7 flex items-center justify-center rounded-full bg-purple-200 text-purple-700 font-bold hover:bg-purple-300 hover:scale-110 transition-all" data-qty-dec="${item.id}">-</button>
              <span class="min-w-[2rem] text-center text-purple-900 font-bold">${item.quantity}</span>
              <button type="button" class="focus-outline w-7 h-7 flex items-center justify-center rounded-full bg-purple-200 text-purple-700 font-bold hover:bg-purple-300 hover:scale-110 transition-all" data-qty-inc="${item.id}">+</button>
            </div>
            <div class="flex flex-col items-end">
              <span class="text-base font-bold text-purple-600">‚Çπ${item.price * item.quantity}</span>
              <button type="button" class="focus-outline mt-1 text-xs text-pink-500 hover:text-pink-700 font-semibold hover:scale-110 transition-all" data-remove="${item.id}">üóëÔ∏è Remove</button>
            </div>
          `;
          container.appendChild(row);
        });
      }

      const total = cart.reduce((acc, cur) => acc + cur.price * cur.quantity, 0);
      document.getElementById("cartTotal").textContent = total.toString();
      updateCartCount();
    }

    function handleCartInteractions() {
      document.getElementById("cartItems").addEventListener("click", e => {
        const dec = e.target.closest("[data-qty-dec]");
        const inc = e.target.closest("[data-qty-inc]");
        const rem = e.target.closest("[data-remove]");
        if (dec) {
          const id = dec.getAttribute("data-qty-dec");
          const item = cart.find(i => i.id === id);
          if (!item) return;
          if (item.quantity > 1) {
            item.quantity -= 1;
          } else {
            cart = cart.filter(i => i.id !== id);
          }
          renderCart();
        } else if (inc) {
          const id = inc.getAttribute("data-qty-inc");
          const item = cart.find(i => i.id === id);
          if (!item) return;
          item.quantity += 1;
          renderCart();
        } else if (rem) {
          const id = rem.getAttribute("data-remove");
          cart = cart.filter(i => i.id !== id);
          renderCart();
        }
      });

      document.getElementById("placeOrderBtn").addEventListener("click", () => {
        if (cart.length === 0) {
          showStatus("Your cart is empty.", "error");
          return;
        }
        const total = cart.reduce((acc, cur) => acc + cur.price * cur.quantity, 0);
        const orderId = "ORD-" + String(orders.length + 1).padStart(3, "0");
        const time = new Date().toLocaleString();
        const orderItems = cart.map(i => ({ ...i }));
        orders.unshift({ id: orderId, items: orderItems, total, time });
        cart = [];
        renderCart();
        renderOrders();
        setActiveSection("orders");
        showStatus("Order placed! You can now add a review from your orders.");
      });
    }

    // -------- Orders --------
    function renderOrders() {
      const container = document.getElementById("ordersList");
      container.innerHTML = "";
      if (orders.length === 0) {
        container.innerHTML = '<p class="text-xs text-slate-400">You haven‚Äôt placed any orders yet.</p>';
        return;
      }
      orders.forEach(order => {
        const card = document.createElement("article");
        card.className =
          "rounded-xl border border-slate-800 bg-slate-900/80 px-3 py-2 flex flex-col gap-1";
        const itemsText = order.items
          .map(i => `${i.name} √ó${i.quantity}`)
          .join(", ");
        const reviewableItems = order.items
          .map(i => {
            const reviewed = reviews.some(r => r.itemId === i.id && r.itemName === i.name);
            return { ...i, reviewed };
          });

        card.innerHTML = `
          <div class="flex items-center justify-between gap-2">
            <div>
              <p class="text-xs font-semibold text-slate-100">Order ${order.id}</p>
              <p class="text-[11px] text-slate-500">${order.time}</p>
            </div>
            <span class="text-sm font-semibold text-emerald-300">‚Çπ${order.total}</span>
          </div>
          <p class="text-[11px] text-slate-300">Items: ${itemsText}</p>
          <div class="mt-1 flex flex-wrap gap-1">
            ${reviewableItems
              .map(i => {
                if (i.reviewed) {
                  return `<span class="text-[10px] px-2 py-0.5 rounded-full bg-emerald-500/20 text-emerald-300">Reviewed: ${i.name}</span>`;
                }
                return `<button type="button" class="focus-outline text-[10px] px-2 py-0.5 rounded-full border border-slate-700 text-slate-200 hover:bg-slate-800" data-review-item="${i.id}" data-review-name="${i.name}">Review ${i.name}</button>`;
              })
              .join("")}
          </div>
        `;
        container.appendChild(card);
      });

      container.addEventListener(
        "click",
        e => {
          const btn = e.target.closest("[data-review-item]");
          if (!btn) return;
          const itemId = btn.getAttribute("data-review-item");
          const itemName = btn.getAttribute("data-review-name") || "";
          openReviewModal(itemId, itemName);
        },
        { once: true }
      );
    }

    // -------- Reviews --------
    function renderReviews() {
      const container = document.getElementById("reviewsList");
      container.innerHTML = "";
      if (reviews.length === 0) {
        container.innerHTML = '<div class="text-center py-8"><p class="text-4xl mb-2">‚≠ê</p><p class="text-sm text-purple-600 font-medium">No reviews yet. Place an order and share your experience!</p></div>';
        return;
      }
      reviews.forEach(r => {
        const card = document.createElement("article");
        card.className =
          "rounded-2xl border-2 border-purple-300 bg-gradient-to-br from-white to-purple-50 px-4 py-3 flex flex-col gap-2 shadow-lg hover:shadow-xl transition-all";
        const stars = "‚òÖ".repeat(r.rating) + "‚òÜ".repeat(5 - r.rating);
        card.innerHTML = `
          <div class="flex items-center justify-between gap-2">
            <div>
              <p class="text-sm font-bold text-purple-900">${r.itemName}</p>
              <p class="text-xs text-purple-600">${r.time}</p>
            </div>
            <span class="text-xl text-yellow-500 drop-shadow-md">${stars}</span>
          </div>
          <p class="text-xs text-purple-700 mt-1 italic">"${r.text || "No comment provided"}"</p>
        `;
        container.appendChild(card);
      });
    }

    // -------- Review Modal --------
    function openReviewModal(itemId, itemName) {
      reviewContext = { itemId, itemName };
      currentRating = 0;
      document.getElementById("reviewItemName").textContent = itemName;
      document.getElementById("reviewText").value = "";
      updateStarDisplay();
      const modal = document.getElementById("reviewModal");
      modal.classList.remove("hidden");
      modal.classList.add("flex");
      document.getElementById("reviewText").focus();
    }

    function closeReviewModal() {
      const modal = document.getElementById("reviewModal");
      modal.classList.add("hidden");
      modal.classList.remove("flex");
      reviewContext = { itemId: null, itemName: "" };
      currentRating = 0;
    }

    function updateStarDisplay() {
      document.querySelectorAll("#reviewModal .star").forEach(star => {
        const r = Number(star.getAttribute("data-rating"));
        if (r <= currentRating) {
          star.classList.add("active");
        } else {
          star.classList.remove("active");
        }
      });
    }

    function initReviewModal() {
      document.querySelectorAll("#reviewModal .star").forEach(star => {
        star.addEventListener("click", () => {
          currentRating = Number(star.getAttribute("data-rating"));
          updateStarDisplay();
        });
      });

      document.getElementById("cancelReviewBtn").addEventListener("click", closeReviewModal);
      document.getElementById("closeReviewModalBtn").addEventListener("click", closeReviewModal);
      document.getElementById("reviewModal").addEventListener("click", e => {
        if (e.target.id === "reviewModal") {
          closeReviewModal();
        }
      });

      document.getElementById("submitReviewBtn").addEventListener("click", () => {
        if (!reviewContext.itemId) return;
        if (currentRating === 0) {
          showStatus("Please select a rating before submitting.", "error");
          return;
        }
        const text = document.getElementById("reviewText").value.trim();
        const time = new Date().toLocaleString();
        reviews.unshift({
          id: "REV-" + String(reviews.length + 1).padStart(3, "0"),
          itemId: reviewContext.itemId,
          itemName: reviewContext.itemName,
          rating: currentRating,
          text,
          time
        });
        renderReviews();
        renderOrders();
        closeReviewModal();
        showStatus("Review submitted. Thank you!");
      });
    }

    // -------- Logout (demo only) --------
    function initLogout() {
      document.getElementById("logoutBtn").addEventListener("click", () => {
        showStatus("This is a demo ‚Äî logout is not connected.");
      });
    }

    // -------- Sidebar init --------
    function initSidebar() {
      document.querySelectorAll(".menu-btn").forEach(btn => {
        btn.addEventListener("click", () => {
          const section = btn.getAttribute("data-section");
          if (section) setActiveSection(section);
        });
      });
    }

    // -------- Canva Element SDK (for future customization) --------
    (function initElementSdk() {
      if (!window.elementSdk) return;

      const defaultConfig = {
        app_title: "Campus Food Hub",
        welcome_text: "Welcome, Student",
        font_family: "system-ui",
        font_size: 14,
        background_color: "#f8f7ff",
        surface_color: "#ffffff",
        text_color: "#4c1d95",
        primary_action_color: "#9333ea",
        secondary_action_color: "#c084fc"
      };

      window.elementSdk.init({
        defaultConfig,
        onConfigChange: async (config) => {
          const cfg = { ...defaultConfig, ...config };
          const baseFont = cfg.font_family || defaultConfig.font_family;
          const baseSize = Number(cfg.font_size || defaultConfig.font_size);

          const appTitle = document.getElementById("appTitle");
          const studentName = document.getElementById("studentName");
          const body = document.body;

          if (appTitle) appTitle.textContent = cfg.app_title;
          if (studentName) studentName.textContent = cfg.welcome_text;

          // Fonts & sizes
          const fullStack = `${baseFont}, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif`;
          body.style.fontFamily = fullStack;
          appTitle && (appTitle.style.fontSize = (baseSize * 1.4) + "px");
          studentName && (studentName.style.fontSize = (baseSize * 0.9) + "px");
          document.querySelectorAll("p, button, input, select, textarea, span, li, label").forEach(el => {
            el.style.fontSize = baseSize + "px";
          });

          // Colors
          body.style.backgroundColor = cfg.background_color;
          document.querySelectorAll(".bg-slate-900, .bg-slate-900\\/60, .bg-slate-900\\/70, .bg-slate-900\\/80")
            .forEach(el => { el.style.backgroundColor = cfg.surface_color; });
          document.querySelectorAll("h1, h2, h3, p, span, label, input, select, textarea")
            .forEach(el => { el.style.color = cfg.text_color; });
          document.querySelectorAll("button")
            .forEach(el => {
              if (el.className.includes("bg-emerald-500")) {
                el.style.backgroundColor = cfg.primary_action_color;
              } else {
                el.style.backgroundColor = cfg.secondary_action_color;
              }
            });
        },
        mapToCapabilities: (config) => {
          const cfg = { ...config };
          return {
            recolorables: [
              {
                get: () => cfg.background_color || "#020617",
                set: (value) => {
                  cfg.background_color = value;
                  window.elementSdk.setConfig({ background_color: value });
                }
              },
              {
                get: () => cfg.surface_color || "#020617",
                set: (value) => {
                  cfg.surface_color = value;
                  window.elementSdk.setConfig({ surface_color: value });
                }
              },
              {
                get: () => cfg.text_color || "#e2e8f0",
                set: (value) => {
                  cfg.text_color = value;
                  window.elementSdk.setConfig({ text_color: value });
                }
              },
              {
                get: () => cfg.primary_action_color || "#22c55e",
                set: (value) => {
                  cfg.primary_action_color = value;
                  window.elementSdk.setConfig({ primary_action_color: value });
                }
              },
              {
                get: () => cfg.secondary_action_color || "#0f172a",
                set: (value) => {
                  cfg.secondary_action_color = value;
                  window.elementSdk.setConfig({ secondary_action_color: value });
                }
              }
            ],
            borderables: [],
            fontEditable: {
              get: () => cfg.font_family || "system-ui",
              set: (value) => {
                cfg.font_family = value;
                window.elementSdk.setConfig({ font_family: value });
              }
            },
            fontSizeable: {
              get: () => Number(cfg.font_size || 14),
              set: (value) => {
                cfg.font_size = value;
                window.elementSdk.setConfig({ font_size: value });
              }
            }
          };
        },
        mapToEditPanelValues: (config) => {
          const m = new Map();
          m.set("app_title", config.app_title || "Campus Food Hub");
          m.set("welcome_text", config.welcome_text || "Welcome, Student");
          return m;
        }
      });
    })();

    // -------- Init --------
    document.addEventListener("DOMContentLoaded", () => {
      populateVendorFilter();
      renderMenu();
      renderCart();
      renderOrders();
      renderReviews();
      initSidebar();
      handleBrowseInteractions();
      handleCartInteractions();
      initReviewModal();
      initLogout();
      setActiveSection("browse");
    });
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9a19d1ae724a91da',t:'MTc2MzY2MTMzNS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>